apiVersion: 1.0.0
metadata:
  generateName: angular-
projects:
  - name: angular-realworld-example-app
    source:
      location: "https://github.com/gothinkster/angular-realworld-example-app"
      type: git
components:
  # - type: cheEditor
  #   reference: https://raw.githubusercontent.com/ng-plus-dev/ngplus-workspaces/main/ngplus-editor.meta.yaml
  - id: che-incubator/typescript/latest
    type: chePlugin
  - type: chePlugin
    reference: "https://raw.githubusercontent.com/GuanglongDu/che-analyzer/master/plugin.yaml"
    alias: analyzer
  - mountSources: true
    endpoints:
      - name: angular
        port: 4200
    memoryLimit: 1Gi
    type: dockerimage
    image: "quay.io/eclipse/che-nodejs10-community@sha256:80ac6a66649765df29d631351ee2c680aae5d45d71f49adbfb100b5f49625549"
    alias: nodejs
  - mountSources: true
    endpoints:
      - name: copilot
        port: 8777
    command:
      - /bin/sh
    args:
      - "-c"
      - /app/copilot-analyzer
    memoryLimit: 1Gi
    type: dockerimage
    image: "davydu/copilot-server:2.0.0"
    alias: copilot
    env:
      - value: "8777"
        name: SERVER_PORT
  - id: donjayamanne/githistory/latest
    type: chePlugin
commands:
  - name: yarn install
    actions:
      - type: exec
        component: nodejs
        command: yarn install
        workdir: "${CHE_PROJECTS_ROOT}/angular-realworld-example-app"
  - name: build
    actions:
      - type: exec
        component: nodejs
        command: yarn run build
        workdir: "${CHE_PROJECTS_ROOT}/angular-realworld-example-app"
  - name: start
    actions:
      - type: exec
        component: nodejs
        command: yarn run start --host 0.0.0.0 --disableHostCheck true
        workdir: "${CHE_PROJECTS_ROOT}/angular-realworld-example-app"
  - name: lint
    actions:
      - type: exec
        component: nodejs
        command: yarn run lint
        workdir: "${CHE_PROJECTS_ROOT}/angular-realworld-example-app"
